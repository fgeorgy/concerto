<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="initial-scale=1.0, maximum-scale=4.0, user-scalable=yes, width=device-width" />
<meta name="apple-mobile-web-app-capable" content="yes">

<title>Concerto MusicXML Parser Demo</title>

<script src="/bower_components/raphael/raphael-min.js"></script>
<script src="/bower_components/vexflow/build/vexflow/vexflow-min.js"></script>
<script src="/bower_components/jquery/dist/jquery.min.js"></script>
<script src="/bower_components/tv4/tv4.js"></script>
<script src="./../build/concerto-min.js"></script>
<!--
<script src="./../src/concerto.js"></script>
<script src="./../src/table.js"></script>
<script src="./../src/parser.js"></script>
<script src="./../src/attributesmanager.js"></script>
<script src="./../src/layoutmanager.js"></script>
<script src="./../src/notemanager.js"></script>
<script src="./../src/measuremanager.js"></script>
<script src="./../src/barlinemanager.js"></script>
<script src="./../src/converter.js"></script>
<script src="./../src/renderer.js"></script>
-->

<script>
var musicjson;

var examples = [
    './examples/scales.xml',
    './examples/sonata16.xml', // x
    './examples/adeste.xml',
    './examples/inv4.xml',
    './examples/inv1.xml',
    './examples/test_notations.xml',
    './examples/blank_a7.xml'
];

function onReady(schema) {
    // use xml example instead of using templates.js
    $.ajax({
        url: examples[6],
        data: null,
        success: function( data ) {
            musicjson = Concerto.Converter.toJSON(data);
            var valid = tv4.validate(musicjson, schema);
            if(valid) { console.log('pre-validation success'); }
            else { console.log(tv4.error); }

            console.log(musicjson);
            var $container = $("#container");
            var renderer = new Concerto.Renderer($container, musicjson);
            renderer.draw();
            var valid = tv4.validate(musicjson, schema);
            if(valid) { console.log('post-validation success'); }
            else { console.log(tv4.error); }
        },
        dataType: 'xml'
    });
    
}

$(document).ready(function() { 
    $.getJSON('/schema/musicjson.json', function(schema) {
        onReady(schema);
    });
});

</script>
<style type="text/css">
#container {
    width:100%;
    text-align:center;
}

#container > div {
    background-color:#eed;
    margin:auto;
    margin-bottom:10px;
}

</style>
</head>
<body>
    <div id="container">
    </div>
</body>
</html>

